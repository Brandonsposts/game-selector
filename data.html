<!doctype html>
<html>
<!-- comment-->
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="author" content="co-authored by Brandon Post, Chase Terry">
    <title>Game Selector</title>
    
    <!-- JQuery Mobile Setup -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="http://code.jquery.com/mobile/1.0.1/jquery.mobile-1.0.1.min.css" />
    <script src="http://code.jquery.com/jquery-1.6.4.min.js"></script>
    <script src="http://code.jquery.com/mobile/1.0.1/jquery.mobile-1.0.1.min.js"></script>
    <!-- End JQuery Mobile Setup -->

    <script>
      //javascript
      
      var games = [];
      
      function game(name, isBoard, isCard, categoryArray, minPlayers, maxPlayers, appletArray){
        this.name = name;
        this.isBoard = isBoard;
        this.isCard = isCard;
        this.categoryArray = categoryArray;
        this.minPlayers = minPlayers;
        this.maxPlayers = maxPlayers;
        this.appletArray = appletArray;
      }
      
      function addToDatabase(object){
        if(hasLocalStorage()){
          if(localStorage.database){
            alert("next");
            //games.sort(function(a, b){return a.name.localeCompare(b.name)});
            var oldDatabase = JSON.parse(localStorage.database);
            games = oldDatabase;
            games.push(object);
            localStorage.database = JSON.stringify(games);
          } 
          else{
            alert("first");
            localStorage.database = JSON.stringify(games);
          }
          var temp = JSON.parse(localStorage.database);
        }
        else{
          alert("No HTML5 Local Storage");
        }
      }
      
      function dataInput(){
        var name = document.getElementById("game-name").value;
        var isBoard = !!(document.getElementById("board-or-card").value);
        var isCard = !(document.getElementById("board-or-card").value);
        var catArray = [$('#strategy').is(':checked'), $('#action').is(':checked')];
        var min = document.getElementById("min-players").value;
        var max = document.getElementById("max-players").value;
        var appArray = [$('#dice').is(':checked'), $('#starting-player').is(':checked')];
        var game1 = new game(name, isBoard, isCard, catArray, min, max, appArray);
        addToDatabase(game1);
      }
      
      function deleteGame(number){
        alert("Attempt delete");
        alert("test: "+number);
        return;
        var newGames = [];
        for(i = 0; i < number; i++)
        {
          newGames.push(games[i]);
        }
        for(j = number + 1; j < games.length; j++)
        {
          newGames.push(games[j]); 
        }
        alert("deleted: "+games[number].name);
        games = newGames;
      }

      
      //All testing
      function clickCounter(){
        alert("Still broken");
        if(hasLocalStorage()){
          if(localStorage.clickcount){
            alert("next");
            localStorage.clickcount = Number(localStorage.clickcount)+1;
          } 
          else{
            alert("first");
            localStorage.clickcount = 1;
          }
          document.getElementById("clickcount-data").innerHTML = "You have clicked the button " + localStorage.clickcount + " time(s).";
        }
        else{
          alert("No HTML5 Local Storage");
        }
        alert("pass through");
      }
      
      function hasLocalStorage(){
        if(typeof(Storage) !== "undefined"){
          //has local storage
          return true;
        }
        else{
          //does not have local storage
          return false;
        }
      }
      
      function showList(){
        if(hasLocalStorage()){
          alert("try change");
          var newDatabase = JSON.parse(localStorage.database);
          //document.getElementById("result-1").innerHTML = newDatabase[0].name;
          var x = 1;
          document.getElementById("result-1").innerHTML = "<li <p>" + newDatabase[x].name + "</p><a onclick='deleteGame("+x+");'>H</a></li>"
          //document.getElementById("result-2").innerHTML = "<li id='result-2' data-icon='delete'>"+newDatabase[x].name+"<a onclick='deleteGame()'>data-icon='delete'</a></li>";
          document.getElementById("result-3").innerHTML = ""+newDatabase[x].name+"<a onclick='deleteGame(10)'>data-icon='delete'</a></li>";
          //document.getElementById("result-4").innerHTML = computeResult(4);
          document.getElementById("result-5").innerHTML = newDatabase[1].name;
          //document.getElementById("result-6").innerHTML = computeResult(6);
        }
      }
      
      
    </script>
  </head>
  <body>
    <!-- main html -->
    <div data-role="page" id="datapage">
      <div data-role="header">
        <h1>My Title</h1>
      </div><!-- /header -->
      
      <div data-role="navbar" class="header">
        <ul>
          <li><a href="data.html" data-transition="fade" class="ui-btn-active ui-state-persist">Data</a></li>
          <li><a href="index.html" data-transition="slide" rel="external">Home</a></li>
          <li><a href="extras.html" data-transition="slide" rel="external">Extras</a></li>
        </ul>
      </div> <!-- navbar -->
      
      
      <div data-role="main" class="ui-content">
        <!--
        <h3>Local Storage testing</h3>
        <p id="clickcount-data">Hello</p>
        <p><a data-role="button" data-inline="true" onclick="clickCounter();">Increase Counter!</a></p>   
        -->
        <a href="#edit" data-role="button" data-mini="true" align="right" onclick="showList();" data-inline="true" data-transition="none">Edit/view list</a>
        <form align="center">
          <h1>Game Input:</h1>
          <label for="game-name">Name of Game:</label>
          <input type="text" name="game-name" id="game-name" data-clear-btn="true">
          <label for="board-or-card">Board or Card game:</label>
            <select name="slider" id="board-or-card" data-role="slider">
              <option value="board">Board</option>
              <option value="card">Card</option>
            </select>
          <fieldset data-role="controlgroup">
            <legend>Select All Categories:</legend>
            <label for="strategy">Strategy</label>
            <input type="checkbox" name="strategy" id="strategy">
            <label for="action">Action</label>
            <input type="checkbox" name="action" id="action">
          </fieldset>
          <label for="min-players">Minimum number of players:</label>
          <input type="range" name="min-players" id="min-players" min="1" max="10" value="2">
          <label for="max-players">Maximum number of players:</label>
          <input type="range" name="max-players" id="max-players" min="1" max="15" value="4">
          <fieldset data-role="controlgroup">
            <legend>Associated Applets:</legend>
            <label for="dice">Dice</label>
            <input type="checkbox" name="dice" id="dice">
            <label for="starting-player">Starting player selector</label>
            <input type="checkbox" name="starting-player" id="starting-player">
          </fieldset>
          <!--<input type="submit" value="Submit" data-icon="check" data-iconpos="right" data-inline="true">-->
        </form>
        <a data-role="button" data-inline="true" onclick="dataInput();">Submit</a>
      </div><!-- /content -->
    </div><!-- /page -->
    
    <div data-role="page" id="edit">
      <div data-role="header">
        <h1>My Title</h1>
      </div><!-- /header -->
      
      <div data-role="navbar" class="header">
        <ul>
          <li><a href="data.html" data-transition="fade" class="ui-btn-active ui-state-persist">Data</a></li>
          <li><a href="index.html" data-transition="slide" rel="external">Home</a></li>
          <li><a href="extras.html" data-transition="slide" rel="external">Extras</a></li>
        </ul>
      </div> <!-- navbar -->
      
      <div data-role="main" class="ui-content">
        <a href="#datapage" data-role="button" data-mini="true" align="right" data-inline="true" data-transition="none">Go back</a>
        <a data-role="button" data-mini="true" align="right" onclick="showList();" data-inline="true">Edit/view list</a>
        <h1 align="center" >List:</h1>
        <ul data-role="listview" data-filter="true" data-inset="true" align="center">
          <li 
            id="result-1">result-1 <span class="ui-li-count">result-2-count</span>
            <a onclick="deleteGame(0);">Delete item</a>
          </li>
          <li id="result-2" data-icon="delete"><a onclick="deleteGame(2)"></a></li>
          <li id="result-3">result-3 </li>
          <li id="result-4">result-4 </li>
          <li id="result-5" data-icon="delete">Hello<a onclick="deleteGame(5)"></a></li>
          <li id="result-6">result-6 <span class="ui-li-count">result-6-count</span></li>
        </ul>
        
      </div><!-- /content -->
    </div><!-- /page -->
    
    
  </body>
</html>
